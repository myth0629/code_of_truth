# 🔍 진실의 코드 (Truth Code)

AI 기반 웹 추리 게임 - LLM이 생성한 살인 사건의 진실을 파헤치세요!

## 📖 게임 소개

**진실의 코드**는 플레이어가 수사관이 되어 AI가 생성한 살인 사건의 진실을 밝혀내는 추리 게임입니다.

### 🎮 핵심 플레이 방식

- **자유로운 심문**: 지능형 NPC에게 텍스트로 자유롭게 질문하며 심문을 진행합니다
- **숨겨진 비밀**: 각 NPC는 자신만의 '핵심 거짓말'을 가지고 있으며, 진실을 은폐하려고 합니다
- **AI 생성 시나리오**: 매번 새로운 살인 사건 시나리오가 자동으로 생성됩니다

### 🧠 혁신적인 점수 시스템

단순히 범인을 맞추는 것을 넘어, 추리 효율성을 평가합니다:

- **질문 횟수**: 적은 질문으로 사건을 해결할수록 높은 점수
- **질문 품질**: AI가 실시간으로 질문의 논리성, 구체성, 효율성을 평가
- **최종 점수**: 1000점 만점 (질문 품질 500점 + 효율성 500점)
- **등급 시스템**: S, A, B, C, D 등급으로 추리 실력 평가

## 🛠️ 기술 스택

- **백엔드**: Python Flask
- **AI 모델**: Google Gemini 2.0 Flash (gemini-2.0-flash-exp)
- **프론트엔드**: HTML5, CSS3, JavaScript (Vanilla)
- **데이터 저장**: 인메모리 Dictionary (확장 가능)

## 📋 사전 요구사항

- Python 3.8 이상
- Google Gemini API Key ([발급받기](https://aistudio.google.com/app/apikey))

## 🚀 설치 및 실행

### 1. 저장소 클론 (또는 파일 다운로드)

```bash
cd /Users/macbook/Desktop/workspace/ai/Game
```

### 2. 가상환경 생성 및 활성화

```bash
# 가상환경 생성
python3 -m venv venv

# 가상환경 활성화 (macOS/Linux)
source venv/bin/activate

# 가상환경 활성화 (Windows)
# venv\Scripts\activate
```

### 3. 의존성 패키지 설치

```bash
pip install -r requirements.txt
```

### 4. 환경 변수 설정

`.env.example` 파일을 복사하여 `.env` 파일을 생성하고, API 키를 설정합니다:

```bash
cp .env.example .env
```

`.env` 파일을 열어 다음 내용을 수정하세요:

```env
GEMINI_API_KEY=your_actual_api_key_here
FLASK_SECRET_KEY=your_secret_key_here
FLASK_DEBUG=True
```

### 5. 애플리케이션 실행

```bash
python app.py
```

### 6. 브라우저에서 접속

```
http://localhost:5000
```

## 🎯 게임 플레이 방법

### 1단계: 게임 시작
- "게임 시작" 버튼을 클릭하면 AI가 새로운 살인 사건을 생성합니다
- 사건 정보, 피해자, 장소, 시간 등이 표시됩니다

### 2단계: 용의자 심문
- 3명의 용의자(NPC) 중 한 명을 선택합니다
- 자유롭게 질문을 작성하여 심문을 진행합니다
- 각 질문은 AI가 실시간으로 품질을 평가합니다 (1-100점)

### 3단계: 추리 및 범인 지목
- 질문을 통해 얻은 정보를 바탕으로 추리합니다
- "범인 지목하기" 버튼을 눌러 범인을 선택합니다

### 4단계: 결과 확인
- 정답을 맞추면 최종 점수와 등급이 표시됩니다
- 질문 횟수와 평균 질문 품질을 기반으로 점수가 계산됩니다

## 📊 점수 계산 방식

### 총점: 1000점 만점

#### 1. 질문 품질 점수 (500점)
```
질문 품질 점수 = 500 × (평균 질문 점수 / 100)
```

#### 2. 효율성 점수 (500점)
- 질문 10회 이하: 500점
- 질문 11-20회: 500 - (질문 횟수 - 10) × 25점
- 질문 21회 이상: 250 - (질문 횟수 - 20) × 50점 (최소 0점)

#### 3. 등급
- **S등급**: 900점 이상
- **A등급**: 800-899점
- **B등급**: 700-799점
- **C등급**: 600-699점
- **D등급**: 600점 미만

## 🔧 주요 기능

### API 엔드포인트

| 엔드포인트 | 메서드 | 설명 |
|-----------|--------|------|
| `/` | GET | 메인 게임 페이지 |
| `/start` | POST | 새 게임 시작 및 시나리오 생성 |
| `/ask` | POST | NPC에게 질문하기 |
| `/accuse` | POST | 범인 지목하기 |
| `/hint` | POST | 힌트 받기 (점수 감점) |
| `/game/<session_id>` | GET | 게임 상태 조회 |

### 시나리오 생성
- Gemini AI가 매번 새로운 살인 사건을 생성합니다
- 범인, 용의자, 증거, 알리바이 등이 자동으로 구성됩니다

### NPC AI
- 각 NPC는 고유한 성격과 비밀을 가지고 있습니다
- 질문에 대해 성격에 맞게 답변하며, 비밀을 숨기려고 합니다
- 이전 대화 내용을 기억하여 일관성 있는 대화를 진행합니다

### 질문 평가 (LLM as a Judge)
- 논리성 (30점): 질문이 논리적이고 추리에 도움이 되는가?
- 구체성 (30점): 질문이 구체적이고 명확한가?
- 효율성 (40점): 질문이 사건 해결에 직접적으로 기여하는가?

## 📁 프로젝트 구조

```
Game/
├── app.py                 # Flask 메인 애플리케이션
├── requirements.txt       # Python 의존성 패키지
├── .env.example          # 환경 변수 템플릿
├── .gitignore            # Git 제외 파일
├── README.md             # 프로젝트 문서
├── templates/
│   └── index.html        # 게임 UI 템플릿
└── static/               # 정적 파일 (필요시 추가)
```

## 🎨 UI 특징

- **반응형 디자인**: 모바일, 태블릿, 데스크톱 모두 지원
- **실시간 피드백**: 질문 품질이 실시간으로 표시됩니다
- **직관적인 인터페이스**: 카드 기반 NPC 선택, 채팅형 대화 기록
- **애니메이션**: 부드러운 전환 효과와 모달 창

## 🔒 보안 고려사항

- API 키는 반드시 `.env` 파일에 저장하고 `.gitignore`에 추가하세요
- 프로덕션 환경에서는 `FLASK_SECRET_KEY`를 강력한 랜덤 값으로 변경하세요
- 프로덕션 배포 시 `FLASK_DEBUG=False`로 설정하세요

## 🚀 향후 개선 사항

- [ ] SQLite/PostgreSQL 데이터베이스 연동으로 게임 기록 저장
- [ ] 사용자 계정 시스템 및 리더보드
- [ ] 난이도 선택 (쉬움, 보통, 어려움)
- [ ] 더 다양한 사건 테마 (강도, 사기, 납치 등)
- [ ] 멀티플레이어 협동 모드
- [ ] 음성 인식 질문 입력
- [ ] 이미지 생성으로 NPC 프로필 사진 추가

## 🐛 문제 해결

### Gemini API 오류
- API 키가 올바른지 확인하세요
- 할당량 초과 여부를 확인하세요 ([콘솔](https://aistudio.google.com/))

### Flask 실행 오류
- 가상환경이 활성화되었는지 확인하세요
- 의존성 패키지가 모두 설치되었는지 확인하세요: `pip list`

### 포트 충돌
- 5000번 포트가 이미 사용 중이라면 `.env` 파일에 `PORT=8000` 등으로 변경하세요

## 📝 라이선스

이 프로젝트는 교육 및 포트폴리오 목적으로 제작되었습니다.

## 👨‍💻 개발자

게임 기획 및 개발 by GitHub Copilot

## 🙏 감사의 말

- Google Gemini API를 제공해주신 Google에 감사드립니다
- Flask 프레임워크 개발자분들께 감사드립니다

---

**즐거운 추리 되세요! 🕵️‍♂️🔍**
